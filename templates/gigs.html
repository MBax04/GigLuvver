{% extends 'base.html' %}
{% load staticfiles %}
{% load custom_filters %}

{% block title_block %}
GigLuvver - Gigs
{% endblock %}

{% block body_block %}
<h1>Gigs</h1>

<select id="venue-select">
    <option value="">All Venues</option>
    {% for venue in venues %}
        <option value="{{ venue.id }}">{{ venue.VenueName }}</option>
    {% endfor %}
</select>

<select id="performer-select">
    <option value="">All Performers</option>
    {% for performer in performers %}
        <option value="{{ performer.StageName }}">{{ performer.StageName }}</option>
    {% endfor %}
</select>

<select id="genre-select">
    <option value="">All Genres</option>
    {% for genre in genres %}
        <option value="{{ genre }}">{{ genre }}</option>
    {% endfor %}
</select>

<select id="sort-select">
    <option value="default">Sort</option>
    <option value="asc">Sort Ascending by Name</option>
    <option value="desc">Sort Descending by Name</option>
</select>

<ul id="gig-list">
    {% for gig in gigs %}
    <li data-venue="{{ gig.Venue.id }}" data-performers='{% with gig_id=gig.id|stringformat:"d" %}
                                                            {% with key="a"|add:gig_id %}
                                                                {% for performer in context_performers|get_key:key %}
                                                                    {{ performer.StageName }},
                                                                {% endfor %}
                                                            {% endwith %}
                                                        {% endwith %}'
                                        data-genres='{% with gig_id=gig.id|stringformat:"d" %}
                                                        {% with key="a"|add:gig_id %}
                                                            {% for performer in context_performers|get_key:key %}
                                                                {{ performer.Genre }},
                                                            {% endfor %}
                                                        {% endwith %}
                                                    {% endwith %}'
                                        data-id="{{ gig.id }}">
        <a href="{% url 'gigluvver_app:gig' gig.GigID %}">{{ gig.GigName }}</a>
    </li>
    {% empty %}
    <strong>There are no gigs present.</strong>
    {% endfor %}
</ul>


<script src="{% static 'gig_filters.js' %}"></script>

{% endblock %}
